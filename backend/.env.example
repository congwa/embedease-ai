# ========================================
# LLM 提供商配置
# ========================================
# 支持的提供商: openai, anthropic, deepseek, siliconflow 等
# 所有兼容 OpenAI API 格式的提供商都可以使用

# 主要 LLM 提供商
LLM_PROVIDER=siliconflow
LLM_API_KEY=sk-your-api-key-here
LLM_BASE_URL=https://api.siliconflow.cn/v1
LLM_CHAT_MODEL=moonshotai/Kimi-K2-Thinking

# ========================================
# Embeddings 配置
# ========================================
# 可以使用与 LLM 不同的提供商（例如使用更便宜的服务）
# 如果不设置 EMBEDDING_API_KEY 和 EMBEDDING_BASE_URL，将使用 LLM 的配置

EMBEDDING_PROVIDER=siliconflow
EMBEDDING_MODEL=Qwen/Qwen3-Embedding-8B
EMBEDDING_DIMENSION=4096

# 如果 Embeddings 使用不同的提供商，取消注释以下配置：
# EMBEDDING_API_KEY=sk-your-embedding-api-key
# EMBEDDING_BASE_URL=https://api.your-embedding-provider.com/v1

# ========================================
# Rerank 配置
# ========================================
# 重排序功能，用于提升检索结果的相关性

RERANK_ENABLED=true
RERANK_MODEL=Qwen/Qwen3-Reranker-8B
RERANK_TOP_N=5
RERANK_INSTRUCTION=根据查询对商品进行相关性排序

# 如果 Rerank 使用不同的提供商，取消注释以下配置：
# RERANK_PROVIDER=siliconflow
# RERANK_API_KEY=sk-your-rerank-api-key
# RERANK_BASE_URL=https://api.your-rerank-provider.com/v1

# ========================================
# ENV_JSON 目录配置
# ========================================
# 支持将复杂 JSON 配置放在独立文件中，提升可读性和可维护性
# 目录内文件命名规则：<ENV_VAR_NAME>.json（如 MODEL_PROFILES_JSON.json）
# 加载优先级：.env 中的环境变量 > .env.json 目录中的文件
# 留空则不启用目录加载，仅使用 .env 中的内联 JSON
# 详细说明请查看 .env.json/README.md
ENV_JSON_DIR=.env.json

# ========================================
# 模型能力配置
# ========================================
# 手动指定模型能力（JSON 格式），会覆盖 models.dev 的配置
# 支持两种方式：
# 1. 内联 JSON（适合简单配置或临时覆盖）
# 2. 使用 .env.json/MODEL_PROFILES_JSON.json 文件（推荐，支持多行格式化）
# 示例：
# MODEL_PROFILES_JSON={"moonshotai/Kimi-K2-Thinking": {"reasoning_output": true, "tool_calling": true, "structured_output": true}}
MODEL_PROFILES_JSON=

# models.dev 配置（自动获取模型能力信息）
MODELS_DEV_ENABLED=true
MODELS_DEV_API_URL=https://models.dev/api.json
# MODELS_DEV_PROVIDER_ID 默认使用 LLM_PROVIDER，也可以手动指定
# MODELS_DEV_PROVIDER_ID=siliconflow
MODELS_DEV_TIMEOUT_SECONDS=10.0
MODELS_DEV_CACHE_TTL_SECONDS=86400.0

# ========================================
# Qdrant 向量数据库配置
# ========================================
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_COLLECTION=products

# ========================================
# 数据库后端配置
# ========================================
# 数据库类型：sqlite（默认，零配置）| postgres（推荐生产环境）
DATABASE_BACKEND=sqlite

# === SQLite 配置（DATABASE_BACKEND=sqlite 时生效）===
DATABASE_PATH=./data/app.db
CHECKPOINT_DB_PATH=./data/checkpoints.db
CRAWLER_DATABASE_PATH=./data/crawler.db

# === PostgreSQL 配置（DATABASE_BACKEND=postgres 时生效）===
# 启用 PostgreSQL 时需要启动 postgres 服务：
#   docker compose --profile postgres up -d
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=embedeaseai
POSTGRES_PASSWORD=embedeaseai_password
POSTGRES_DB=embedeaseai
# 或直接指定完整 URL（优先级最高）
# POSTGRES_URL=postgresql+asyncpg://user:pass@host:5432/dbname

# === 连接池配置（PostgreSQL 生效）===
DATABASE_POOL_SIZE=5
DATABASE_POOL_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30

# ========================================
# 文本处理配置
# ========================================
CHUNK_SIZE=800
CHUNK_OVERLAP=100

# ========================================
# 服务配置
# ========================================
API_HOST=0.0.0.0
API_PORT=8000
# CORS 跨域配置
# 支持两种方式：
# 1. 逗号分隔字符串（适合简单配置）
# 2. 使用 .env.json/CORS_ORIGINS.json 文件（推荐，支持 JSON 数组格式）
CORS_ORIGINS=http://localhost:3000

# ========================================
# 日志配置
# ========================================
LOG_LEVEL=DEBUG
LOG_MODE=detailed
LOG_FILE=./logs/app.log
LOG_FILE_ROTATION=10 MB
LOG_FILE_RETENTION=7 days

# ========================================
# Agent 工具执行配置
# ========================================
# 工具串行执行：当模型一次返回多个 tool_calls 时，是否强制按顺序执行（而非并行）
# true: 工具调用串行执行，避免并发问题，适合工具间有依赖关系的场景
# false: 工具调用并行执行（默认 LangGraph 行为），执行速度更快
AGENT_SERIALIZE_TOOLS=true

# ========================================
# Agent TODO 规划中间件配置
# ========================================
# 启用后，Agent 会自动注入 write_todos 工具和规划提示
# 用于复杂多步任务（如多商品/多类别/多价格区间）的规划与跟踪
# 模型会在遇到复杂任务时主动创建待办清单，逐步执行并标记完成

AGENT_TODO_ENABLED=true
# 自定义系统提示（可选，留空使用默认的 WRITE_TODOS_SYSTEM_PROMPT）
# 示例：在默认提示前添加业务语境
# AGENT_TODO_SYSTEM_PROMPT=当存在多商品、多类别或多价格区间时，先使用 write_todos 规划步骤。
AGENT_TODO_SYSTEM_PROMPT=
# 自定义工具描述（可选，留空使用默认的 WRITE_TODOS_TOOL_DESCRIPTION）
AGENT_TODO_TOOL_DESCRIPTION=

# ========================================
# Agent 工具调用限制中间件配置
# ========================================
# 限制工具调用次数，防止 Agent 陷入无限循环
# 当达到限制时，根据 EXIT_BEHAVIOR 决定行为

AGENT_TOOL_LIMIT_ENABLED=true
# 线程级限制（跨多次 run 累计），留空表示不限制
# AGENT_TOOL_LIMIT_THREAD=50
AGENT_TOOL_LIMIT_THREAD=100
# 单次 run 限制，默认 20 次
AGENT_TOOL_LIMIT_RUN=20
# 超限行为:
# - continue: 阻止超限的工具调用，但允许其他工具继续执行（默认）
# - error: 抛出异常，立即停止
# - end: 立即结束，注入 ToolMessage + AIMessage 告知用户
AGENT_TOOL_LIMIT_EXIT_BEHAVIOR=continue

# ========================================
# Agent 工具重试中间件配置
# ========================================
# 工具调用失败时自动重试，支持指数退避

AGENT_TOOL_RETRY_ENABLED=true
# 最大重试次数（不含首次调用）
AGENT_TOOL_RETRY_MAX_RETRIES=2
# 指数退避因子（每次重试延迟 = initial_delay * backoff_factor^attempt）
AGENT_TOOL_RETRY_BACKOFF_FACTOR=2.0
# 初始延迟（秒）
AGENT_TOOL_RETRY_INITIAL_DELAY=1.0
# 最大延迟（秒），超过此值则封顶
AGENT_TOOL_RETRY_MAX_DELAY=60.0

# ========================================
# Agent 上下文压缩中间件配置
# ========================================
# 当消息历史过长时自动压缩（使用 LLM 生成摘要替换旧消息）
# 压缩发生时会推送 context.summarized 事件到前端

AGENT_SUMMARIZATION_ENABLED=true
# 触发压缩的阈值（消息数），达到此数量时触发压缩
AGENT_SUMMARIZATION_TRIGGER_MESSAGES=50
# 触发压缩的阈值（Token 数），可选，0 表示不使用
AGENT_SUMMARIZATION_TRIGGER_TOKENS=0
# 保留策略：messages | tokens
AGENT_SUMMARIZATION_KEEP_STRATEGY=messages
# 压缩后保留的最近消息数
AGENT_SUMMARIZATION_KEEP_MESSAGES=20
# 压缩后保留的最近 Token 数（keep_strategy=tokens 时生效）
AGENT_SUMMARIZATION_KEEP_TOKENS=3000
# 用于生成摘要的最大 token 数（避免摘要请求过大）
AGENT_SUMMARIZATION_TRIM_TOKENS=4000
# 摘要专用模型（可选，留空使用主模型，可用更便宜的模型降低成本）
# 示例：AGENT_SUMMARIZATION_MODEL=openai:gpt-4o-mini
AGENT_SUMMARIZATION_MODEL=

# ========================================
# Agent 滑动窗口中间件配置
# ========================================
# 在模型调用前裁剪消息历史，保留最近的 N 条消息或 N 个 Token
# 零 LLM 调用，纯本地操作
# 裁剪发生时会推送 context.trimmed 事件到前端

AGENT_SLIDING_WINDOW_ENABLED=false
# 裁剪策略：messages（按消息数）| tokens（按 Token 数）
AGENT_SLIDING_WINDOW_STRATEGY=messages
# 最大消息数（strategy=messages 时生效）
AGENT_SLIDING_WINDOW_MAX_MESSAGES=50
# 最大 Token 数（strategy=tokens 时生效）
AGENT_SLIDING_WINDOW_MAX_TOKENS=8000

# ========================================
# Agent 噪音过滤中间件配置
# ========================================
# 过滤和截断工具执行的冗长输出，避免干扰模型注意力
# 支持电商场景的 JSON 压缩（商品描述截断、列表限制）
# 零 LLM 调用，纯本地正则处理

AGENT_NOISE_FILTER_ENABLED=true
# 最大输出字符数，超过则截断
AGENT_NOISE_FILTER_MAX_CHARS=2000
# 截断时保留头部字符数
AGENT_NOISE_FILTER_PRESERVE_HEAD=500
# 截断时保留尾部字符数
AGENT_NOISE_FILTER_PRESERVE_TAIL=1000

# ========================================
# PII 检测中间件配置
# ========================================
# 检测并处理个人敏感信息（PII: Personally Identifiable Information）
# 支持多规则配置，每条规则可独立设置类型、策略、应用范围

# 是否启用 PIIMiddleware
AGENT_PII_ENABLED=false

# 默认规则（JSON 数组），支持的配置项：
# - pii_type: 类型名称（内置: email/credit_card/ip/mac_address/url，或自定义）
# - strategy: 处理策略（block/redact/mask/hash）
# - detector: 自定义正则表达式（内置类型留空）
# - apply_to_input: 应用于用户输入（默认 true）
# - apply_to_output: 应用于 Agent 输出（默认 false）
# - apply_to_tool_results: 应用于工具结果（默认 false）
# - enabled: 规则开关（默认 true）
AGENT_PII_DEFAULT_RULES=[{"pii_type":"email","strategy":"redact","apply_to_input":true,"apply_to_output":true,"enabled":true},{"pii_type":"credit_card","strategy":"mask","apply_to_input":true,"apply_to_output":true,"enabled":true},{"pii_type":"phone_cn","strategy":"redact","detector":"1[3-9]\\d{9}","apply_to_input":true,"apply_to_output":true,"enabled":false}]

# ========================================
# Supervisor 多 Agent 编排配置
# ========================================
# 支持将多个 Agent 组合成一个 Supervisor，根据用户意图自动路由

# 全局开关（关闭后所有 Supervisor Agent 回退到单 Agent 模式）
SUPERVISOR_ENABLED=false
# 默认 Supervisor Agent ID（留空则使用默认 Agent）
SUPERVISOR_DEFAULT_AGENT_ID=
# 意图分类超时（秒）
SUPERVISOR_INTENT_TIMEOUT=3.0
# 是否允许多 Agent 协作（同时调用多个子 Agent）
SUPERVISOR_ALLOW_MULTI_AGENT=false

# ========================================
# 商品库画像配置
# ========================================
# 导入商品时自动生成画像摘要，注入 Agent system prompt 指导检索方向
CATALOG_PROFILE_ENABLED=true
CATALOG_PROFILE_TTL_SECONDS=600
CATALOG_PROFILE_TOP_CATEGORIES=3

# ========================================
# 多提供商配置示例
# ========================================

# 示例 1: 使用 OpenAI
# LLM_PROVIDER=openai
# LLM_API_KEY=sk-your-openai-key
# LLM_BASE_URL=https://api.openai.com/v1
# LLM_CHAT_MODEL=gpt-4
# EMBEDDING_MODEL=text-embedding-3-large
# EMBEDDING_DIMENSION=3072

# 示例 2: 使用 DeepSeek
# LLM_PROVIDER=deepseek
# LLM_API_KEY=sk-your-deepseek-key
# LLM_BASE_URL=https://api.deepseek.com/v1
# LLM_CHAT_MODEL=deepseek-chat
# EMBEDDING_MODEL=deepseek-embedding
# EMBEDDING_DIMENSION=1536

# 示例 3: 使用 Anthropic
# LLM_PROVIDER=anthropic
# LLM_API_KEY=sk-your-anthropic-key
# LLM_BASE_URL=https://api.anthropic.com/v1
# LLM_CHAT_MODEL=claude-3-5-sonnet-20241022

# 示例 4: 混合使用（LLM 用 OpenAI，Embeddings 用 SiliconFlow）
# LLM_PROVIDER=openai
# LLM_API_KEY=sk-your-openai-key
# LLM_BASE_URL=https://api.openai.com/v1
# LLM_CHAT_MODEL=gpt-4
# 
# EMBEDDING_PROVIDER=siliconflow
# EMBEDDING_API_KEY=sk-your-siliconflow-key
# EMBEDDING_BASE_URL=https://api.siliconflow.cn/v1
# EMBEDDING_MODEL=Qwen/Qwen3-Embedding-8B
# EMBEDDING_DIMENSION=4096

# ========================================
# 记忆系统配置
# ========================================

# === 总开关 ===
MEMORY_ENABLED=true

# === LangGraph Store（长期记忆基座）===
# 跨会话用户画像存储，存放用户偏好、任务进度等
MEMORY_STORE_ENABLED=true
MEMORY_STORE_DB_PATH=./data/memory_store.db

# === Memory 专用模型配置 ===
# 可以与聊天模型不同，例如使用更便宜/更快的模型进行记忆抽取
# 留空则使用主 LLM 配置
MEMORY_MODEL=
MEMORY_PROVIDER=
MEMORY_API_KEY=
MEMORY_BASE_URL=

# 示例：使用更便宜的模型进行记忆处理
# MEMORY_MODEL=deepseek-chat
# MEMORY_PROVIDER=deepseek
# MEMORY_API_KEY=sk-your-deepseek-key
# MEMORY_BASE_URL=https://api.deepseek.com/v1

# === 事实型长期记忆 ===
# LLM 事实抽取 → 哈希去重 → Qdrant 向量检索
MEMORY_FACT_ENABLED=true
MEMORY_FACT_DB_PATH=./data/facts.db
MEMORY_FACT_COLLECTION=memory_facts
MEMORY_FACT_SIMILARITY_THRESHOLD=0.5
MEMORY_FACT_MAX_RESULTS=10

# === 图谱记忆 ===
# 实体/关系/观察的结构化知识图谱
MEMORY_GRAPH_ENABLED=true
MEMORY_GRAPH_FILE_PATH=./data/knowledge_graph.jsonl

# === 记忆编排 ===
# 三阶段编排：检索判定、上下文注入、异步写入
MEMORY_ORCHESTRATION_ENABLED=true
MEMORY_ASYNC_WRITE=true

# ========================================
# 网站爬取模块配置
# ========================================
# 从网站自动发现商品并导入，支持 SPA 网站和 LLM 智能解析

# === 总开关 ===
CRAWLER_ENABLED=false

# === 爬取专用模型配置 ===
# 可以与聊天模型不同，例如使用更便宜/更快的模型进行页面解析
# 留空则使用主 LLM 配置
CRAWLER_MODEL=
CRAWLER_PROVIDER=
CRAWLER_API_KEY=
CRAWLER_BASE_URL=

# 示例：使用更便宜的模型进行页面解析
# CRAWLER_MODEL=deepseek-chat
# CRAWLER_PROVIDER=deepseek
# CRAWLER_API_KEY=sk-your-deepseek-key
# CRAWLER_BASE_URL=https://api.deepseek.com/v1

# === 浏览器配置 ===
# 使用 Playwright 进行 SPA 页面渲染
CRAWLER_HEADLESS=true
CRAWLER_USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36

# === 爬取限制 ===
# LLM 解析的最大 HTML 长度（超过会截断）
CRAWLER_MAX_HTML_LENGTH=50000
# 默认请求间隔（秒），防止被封禁
CRAWLER_DEFAULT_DELAY=1.0
# 默认最大爬取深度
CRAWLER_DEFAULT_MAX_DEPTH=3
# 默认最大页面数
CRAWLER_DEFAULT_MAX_PAGES=500

# === 调度配置 ===
# 定时检查站点调度配置的间隔（分钟）
CRAWLER_SCHEDULE_CHECK_INTERVAL=5
# 是否在调度器启动时立即执行一次（true/false）
CRAWLER_RUN_ON_START=false

# === 预置站点配置 ===
# 在配置文件中声明预置站点，应用启动时由 site_initializer 自动导入数据库并注册定时任务
# 支持两种方式：
# 1. 内联 JSON（适合简单配置或临时覆盖）
# 2. 使用 .env.json/CRAWLER_SITES_JSON.json 文件（推荐，支持多行格式化）
# 格式：JSON 数组，每个元素包含下列字段（留空则按默认策略处理）：
#   - id：站点唯一 ID；若缺省则根据 start_url 域名生成（example.com -> example_com）
#   - name：站点名称，用于后台展示和日志
#   - start_url：爬虫入口 URL，同时用于提取域名、初始化 URL 队列
#   - status：站点状态（ACTIVE/INACTIVE），决定是否参与调度
#   - link_pattern：用于过滤要继续爬取的链接（正则或 glob）
#   - max_depth / max_pages：限制递归深度与最大页面数，防止无限遍历
#   - crawl_delay：单站点请求间隔（秒），降低被封风险
#   - is_spa：是否需要 SPA 渲染；true 时会执行 Playwright 等待逻辑
#   - wait_for_selector：SPA 时优先等待的 CSS 选择器，保证关键元素渲染完成；若留空则回退到等待 networkidle（网络空闲）networkidle 等待成功后，代码立即调用 page.content() 把当前 DOM 序列化成 HTML，并返回给爬虫逻辑。无论是通过 selector 还是 networkidle，只要 _fetch_page 返回了 HTML，就会进入后续的解析、字段提取和入库流程。
#   - wait_timeout：等待 selector 或 networkidle 的超时（秒），超时会写日志后继续
#   - extraction_config：JSON 字段提取配置（CSS 选择器或 LLM 模式）
#   - cron_expression：可选 Cron 表达式，声明调度频率；留空则不自动定时
# 注意：
# 1. 同域名只能有一个站点：系统会根据 start_url 提取域名并去重
# 2. 系统配置站点无法通过 API 删除，如需调整请修改此配置并重启
# 示例：
# CRAWLER_SITES_JSON=[
#   {
#     "id": "example_com",
#     "name": "example官网",
#     "start_url": "http://www.example.com",
#     "cron_expression": "0 2 * * *",
#     "max_depth": 3,
#     "max_pages": 500,
#     "link_pattern": ".*example.com/.*",
#     "is_spa": true,
#     "wait_for_selector": "",
#     "wait_timeout": 30,
#     "crawl_delay": 2,
#     "extraction_config": {
#       "mode": "selector",
#       "product_page_indicator": "main .pro-detail",          // 示例，可换成详情页特有容器
#       "fields": {
#         "name": "main h1::text",                            // 商品标题
#         "summary": ".pro-hero p::text",                     // 概要
#         "description": ".pro-detail-content",               // 支持富文本
#         "price": ".price strong::text",                     // 如有价格元素
#         "category": "nav .breadcrumb li:last-child::text",
#         "tags": ".tag-list li::text",
#         "brand": ".brand-badge::text",
#         "image_urls": ".gallery img",                       // 多图
#         "specs": ".spec-list li"                            // 规格行
#       }
#     }
#   }
# ]
# CRAWLER_SITES_JSON=[{"id":"example_com","name":"Example 商城","start_url":"https://example.com","cron_expression":"0 2 * * *","max_depth":3,"max_pages":100,"link_pattern":"/products/*","is_spa":true,"wait_for_selector":".product-list"}]
CRAWLER_SITES_JSON=

# ========================================
# 默认 Agent 配置
# ========================================
# 通过配置文件定义默认 Agent，启动时自动写入数据库（幂等）
# 支持两种方式：
# 1. 内联 JSON（适合简单配置）
# 2. 使用 .env.json/DEFAULT_AGENTS_JSON.json 文件（推荐，支持多行格式化）
# 格式：JSON 数组，每个元素定义一个 Agent 及其知识库配置
# 优先级：接口修改 > 配置注入 > 代码默认

# 是否在启动时自动初始化默认 Agent（设为 false 可手动运行脚本）
DEFAULT_AGENTS_BOOTSTRAP_ENABLED=true

# 配置覆盖策略：
# - skip: 若 Agent 已存在则跳过（保留人工修改，默认）
# - update: 若 Agent 已存在则更新（配置优先）
DEFAULT_AGENTS_OVERRIDE_POLICY=skip

# 默认 Agent 配置（JSON 数组格式）
# 支持的字段：
#   - id: Agent 唯一 ID（可选，自动生成 UUID）
#   - name: Agent 名称（必填）
#   - description: 描述
#   - type: 类型（product/faq/kb/custom）
#   - system_prompt: 系统提示词（留空使用类型默认）
#   - is_default: 是否为默认 Agent
#   - middleware_flags: 中间件开关（JSON 对象）
#   - tool_policy: 工具策略（JSON 对象）
#   - tool_categories: 工具类别（JSON 数组）
#   - knowledge_config: 知识库配置（嵌套对象）
#     - id: 知识库 ID（可选）
#     - name: 知识库名称
#     - type: 类型（faq/vector/graph/product/http_api/mixed）
#     - collection_name: 向量库集合名
#     - top_k: 检索数量
#     - rerank_enabled: 是否启用重排序
# 示例（推荐使用 .env.json/DEFAULT_AGENTS_JSON.json 文件）：
# DEFAULT_AGENTS_JSON=[
#   {
#     "id": "agent-product-default",
#     "name": "商品推荐助手",
#     "type": "product",
#     "is_default": true,
#     "middleware_flags": {"todo_enabled": true, "memory_enabled": true},
#     "tool_categories": ["search", "query", "compare", "filter", "category", "featured", "purchase", "guide"]
#   },
#   {
#     "id": "agent-faq-support",
#     "name": "客服问答助手",
#     "type": "faq",
#     "knowledge_config": {
#       "name": "FAQ知识库",
#       "type": "faq",
#       "collection_name": "faq_entries",
#       "top_k": 5
#     }
#   }
# ]
DEFAULT_AGENTS_JSON=

# ========================================
# MinIO 对象存储配置
# ========================================
# 用于图片上传等文件存储功能
# 需要先启动 MinIO 服务：docker compose up -d minio

MINIO_ENABLED=false
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_BUCKET_NAME=chat-images
MINIO_USE_SSL=false
# 公开访问 URL（用于生成图片链接）
MINIO_PUBLIC_URL=http://localhost:9000

# 图片上传限制
IMAGE_MAX_SIZE_MB=10
IMAGE_MAX_COUNT_PER_MESSAGE=5
IMAGE_ALLOWED_TYPES=image/jpeg,image/png,image/webp,image/gif
IMAGE_THUMBNAIL_SIZE=300

# ========================================
# 客服支持配置
# ========================================
# 用户发送消息时自动推送通知，运营可手动介入切换到人工客服模式
# 支持多种通知渠道，可同时启用

# === 企业微信通知 ===
# 通过企业微信应用消息推送新访客通知
# 配置步骤：
# 1. 登录企业微信管理后台 -> 应用管理 -> 创建应用
# 2. 获取 Corp ID（企业信息页面）
# 3. 获取 Agent ID 和 Secret（应用详情页面）
# 4. 设置可信域名和 IP 白名单
WEWORK_CORP_ID=
WEWORK_AGENT_ID=
WEWORK_AGENT_SECRET=
# 接收通知的用户（逗号分隔用户ID，或 @all 发送给全员）
WEWORK_NOTIFY_USERS=@all

# === 通用 Webhook 通知 ===
# 发送 HTTP POST 请求到指定 URL，可对接任意系统
# 请求体格式：{"type": "...", "conversation_id": "...", "message_preview": "...", ...}
NOTIFY_WEBHOOK_URL=
# 可选：HMAC-SHA256 签名密钥，用于验证请求来源
NOTIFY_WEBHOOK_SECRET=

# === 客服控制台配置 ===
# 控制台 URL，用于通知消息中的"查看"链接
# 示例：https://admin.example.com/support
SUPPORT_CONSOLE_URL=
# SLA 等待时间（秒），用户等待超过此时间后发送提醒通知
SUPPORT_SLA_SECONDS=120